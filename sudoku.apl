⎕IO←0
N←1+⍳n×n←3
c ← {K←I i J j←(⍴⍵)⊤(,⍵)⍳0 ⋄ ⍵∘{⍵@(⊂K)⊢⍺}¨N~∊(⍵[I;i;;])(⍵[;;J;j])(⍵[I;;J;])}
s ← {¯1↑t þ{~0∊⊃⌽⍺},⊂⍵}                                                     
t ← {(¯1↓⍵),c⊃⌽⍵}                                                           
p←(4⍴3)⍴0⍎¨'200370009009200007001004002050000800008000900006000040900100500800007600400089001'
